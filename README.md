# Noted-auth

Сервис для авторизации в Noted (https://dnk33.com) с помощью keycloak

ЗАПУСК С ЛОГАМИ УРОВНЯ DEBUG В PRODUCTION СТРОГО ЗАПРЕЩЁН, ТАК КАК В ДЕБАГ ПИШУТСЯ ЧУВСТВИТЕЛЬНЫЕ ДАННЫЕ (ТОКЕНЫ ПОЛЬЗОВАТЕЛЕЙ)

## TODO-list
- Моки, тесты
- CI/CD + codecov
- Добавить версии секретов в метрики

## Rotating secrets

- Postgres: обновляется сам через vault
- Redis: поддерживает два пароля для пользователя: создаём новый, кладём его в vault, ждём обновления (период проверки задаётся в конфиге), удаляем старый
- Keycloak-client-secret: создаём новый, кладём его в vault, ждём обновления (период проверки задаётся в конфиге). Пока не придумал, как это сделать без даунтайма (после пересоздания старый секрет сразу же деактивируется, поэтому регистрация будет недоступна, пока из vault не прилетит новый), поэтому настоятельно рекомендуется закрывать от внешних запросов фаерволлом всё, что требует client secret, чтобы не волноваться по этому поводу